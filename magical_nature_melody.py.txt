from midiutil import MIDIFile

# Create a new MIDI file with one track
midi_file = MIDIFile(1)
track = 0
time = 0
midi_file.addTrackName(track, time, "Magical Nature Melody")
midi_file.addTempo(track, time, 80)  # Slow and magical tempo

# Instrumentation (General MIDI)
HARP = 46
FLUTE = 73
STRINGS = 48

# Add harp arpeggios (magical base)
midi_file.addProgramChange(track, 0, time, HARP)
harp_notes = [60, 64, 67, 72]  # C major arpeggio
for i in range(4):
    for note in harp_notes:
        midi_file.addNote(track, 0, note, time, 0.5, 80)
        time += 0.5

# Add a flute melody (mystical feeling)
midi_file.addProgramChange(track, 1, time, FLUTE)
flute_melody = [(72, 1), (74, 1), (76, 1), (77, 2), (76, 1), (74, 1)]
for note, duration in flute_melody:
    midi_file.addNote(track, 1, note, time, duration, 90)
    time += duration

# Add soft string chords (background harmony)
midi_file.addProgramChange(track, 2, time, STRINGS)
string_chords = [(60, 64, 67), (59, 62, 65), (57, 60, 64), (55, 59, 62)]
for chord in string_chords:
    for note in chord:
        midi_file.addNote(track, 2, note, time, 4, 60)
    time += 4

# Save the MIDI file
with open("magical_nature_melody.mid", "wb") as output_file:
    midi_file.writeFile(output_file)

print("MIDI file 'magical_nature_melody.mid' created successfully!")
